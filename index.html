// 抽出されたデータをフォームに入力
        function populateFormWithData(data) {
            try {
                console.log('受信したデータ:', data); // デバッグ用

                // 数値の文字列をパース（カンマを除去）
                function parseNumber(value) {
                    if (typeof value === 'string') {
                        return parseInt(value.replace(/,/g, '')) || 0;
                    }
                    return parseInt(value) || 0;
                }

                // Difyのレスポンス形式を柔軟に処理
                let actualData = data;
                
                // 様々なレスポンス形式に対応
                if (data.data && data.data.outputs) {
                    actualData = data.data.outputs;
                } else if (data.outputs) {
                    actualData = data.outputs;
                } else if (data.__is_success !== undefined) {
                    actualData = data;
                }

                console.log('処理対象データ:', actualData); // デバッグ用

                // エラーチェック
                if (actualData.__is_success === 0) {
                    // エラーメッセージを表示
                    showUploadStatus(`処理エラー: ${actualData.error || actualData.__reason || 'データ抽出に失敗しました'}`, 'error');
                    return;
                }

                // 成功時の処理
                if (actualData.__is_success === 1) {
                    console.log('データ処理成功 - データを入力中...');
